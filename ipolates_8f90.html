<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NCEPLIBS-ip: ipolates.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NCEPLIBS-ip
   &#160;<span id="projectnumber">3.3.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ipolates_8f90.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">ipolates.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="ipolates_8f90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a3d43f4c2cee7741e076c2ee5728af08c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ipolates_8f90.html#a3d43f4c2cee7741e076c2ee5728af08c">ipolates</a> (IP, IPOPT, KGDSI, KGDSO, MI, MO, KM, IBI, LI, GI, NO, RLAT, RLON, IBO, LO, GO, IRET)</td></tr>
<tr class="memdesc:a3d43f4c2cee7741e076c2ee5728af08c"><td class="mdescLeft">&#160;</td><td class="mdescRight">THIS SUBPROGRAM INTERPOLATES SCALAR FIELDS FROM ANY GRID TO ANY GRID (JOE IRWIN'S DREAM).  <a href="ipolates_8f90.html#a3d43f4c2cee7741e076c2ee5728af08c">More...</a><br /></td></tr>
<tr class="separator:a3d43f4c2cee7741e076c2ee5728af08c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>IREDELL'S POLATE FOR SCALAR FIELDS </p><dl class="section author"><dt>Author</dt><dd>IREDELL </dd></dl>
<dl class="section date"><dt>Date</dt><dd>96-04-10 </dd></dl>

<p class="definition">Definition in file <a class="el" href="ipolates_8f90_source.html">ipolates.f90</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a3d43f4c2cee7741e076c2ee5728af08c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d43f4c2cee7741e076c2ee5728af08c">&#9670;&nbsp;</a></span>ipolates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ipolates </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(20), intent(in)&#160;</td>
          <td class="paramname"><em>IPOPT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(200), intent(in)&#160;</td>
          <td class="paramname"><em>KGDSI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(200), intent(in)&#160;</td>
          <td class="paramname"><em>KGDSO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>MI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>MO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>KM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>IBI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical*1, dimension(mi,km), intent(in)&#160;</td>
          <td class="paramname"><em>LI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mi,km), intent(in)&#160;</td>
          <td class="paramname"><em>GI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>NO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mo), intent(inout)&#160;</td>
          <td class="paramname"><em>RLAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mo), intent(inout)&#160;</td>
          <td class="paramname"><em>RLON</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(km), intent(out)&#160;</td>
          <td class="paramname"><em>IBO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical*1, dimension(mo,km), intent(out)&#160;</td>
          <td class="paramname"><em>LO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mo,km), intent(out)&#160;</td>
          <td class="paramname"><em>GO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>IRET</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>THIS SUBPROGRAM INTERPOLATES SCALAR FIELDS FROM ANY GRID TO ANY GRID (JOE IRWIN'S DREAM). </p>
<p>ONLY HORIZONTAL INTERPOLATION IS PERFORMED. THE FOLLOWING INTERPOLATION METHODS ARE POSSIBLE: (IP=0) BILINEAR (IP=1) BICUBIC (IP=2) NEIGHBOR (IP=3) BUDGET (IP=4) SPECTRAL (IP=6) NEIGHBOR-BUDGET SOME OF THESE METHODS HAVE INTERPOLATION OPTIONS AND/OR RESTRICTIONS ON THE INPUT OR OUTPUT GRIDS, BOTH OF WHICH ARE DOCUMENTED MORE FULLY IN THEIR RESPECTIVE SUBPROGRAMS. THE GRIDS ARE DEFINED BY THEIR GRID DESCRIPTION SECTIONS (PASSED IN INTEGER FORM AS DECODED BY SUBPROGRAM W3FI63). THE CURRENT CODE RECOGNIZES THE FOLLOWING PROJECTIONS: (KGDS(1)=000) EQUIDISTANT CYLINDRICAL (KGDS(1)=001) MERCATOR CYLINDRICAL (KGDS(1)=003) LAMBERT CONFORMAL CONICAL (KGDS(1)=004) GAUSSIAN CYLINDRICAL (KGDS(1)=005) POLAR STEREOGRAPHIC AZIMUTHAL (KGDS(1)=203) ROTATED EQUIDISTANT CYLINDRICAL - E-STAGGER (KGDS(1)=205) ROTATED EQUIDISTANT CYLINDRICAL - B-STAGGER WHERE KGDS COULD BE EITHER INPUT KGDSI OR OUTPUT KGDSO. AS AN ADDED BONUS THE NUMBER OF OUTPUT GRID POINTS AND THEIR LATITUDES AND LONGITUDES ARE ALSO RETURNED. ON THE OTHER HAND, THE OUTPUT CAN BE A SET OF STATION POINTS IF KGDSO(1)&lt;0, IN WHICH CASE THE NUMBER OF POINTS AND THEIR LATITUDES AND LONGITUDES MUST BE INPUT. FOR THE BUDGET APPROACH, A SUBSECTION OF THE GRID MAY BE OUTPUT BY SUBTRACTING KGDSO(1) FROM 255 AND PASSING IN THE LATITUDES AND LONGITUDES OF THE POINTS. INPUT BITMAPS WILL BE INTERPOLATED TO OUTPUT BITMAPS. OUTPUT BITMAPS WILL ALSO BE CREATED WHEN THE OUTPUT GRID EXTENDS OUTSIDE OF THE DOMAIN OF THE INPUT GRID. THE OUTPUT FIELD IS SET TO 0 WHERE THE OUTPUT BITMAP IS OFF.</p>
<p>INPUT ARGUMENT LIST: </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">IP</td><td>- INTEGER INTERPOLATION METHOD (IP=0 FOR BILINEAR; IP=1 FOR BICUBIC; IP=2 FOR NEIGHBOR; IP=3 FOR BUDGET; IP=4 FOR SPECTRAL; IP=6 FOR NEIGHBOR-BUDGET) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">IPOPT</td><td>- INTEGER (20) INTERPOLATION OPTIONS (IP=0: (NO OPTIONS) IP=1: CONSTRAINT OPTION IP=2: (NO OPTIONS) IP=3: NUMBER IN RADIUS, RADIUS WEIGHTS, SEARCH RADIUS IP=4: SPECTRAL SHAPE, SPECTRAL TRUNCATION IP=6: NUMBER IN RADIUS, RADIUS WEIGHTS ...) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">KGDSI</td><td>- INTEGER (200) INPUT GDS PARAMETERS AS DECODED BY W3FI63 </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">KGDSO</td><td>- INTEGER (200) OUTPUT GDS PARAMETERS </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">MI</td><td>- INTEGER SKIP NUMBER BETWEEN INPUT GRID FIELDS IF KM&gt;1 OR DIMENSION OF INPUT GRID FIELDS IF KM=1 </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">MO</td><td>- INTEGER SKIP NUMBER BETWEEN OUTPUT GRID FIELDS IF KM&gt;1 OR DIMENSION OF OUTPUT GRID FIELDS IF KM=1 </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">KM</td><td>- INTEGER NUMBER OF FIELDS TO INTERPOLATE </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">IBI</td><td>- INTEGER (KM) INPUT BITMAP FLAGS </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">LI</td><td>- LOGICAL*1 (MI,KM) INPUT BITMAPS (IF RESPECTIVE IBI(K)=1) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">GI</td><td>- REAL (MI,KM) INPUT FIELDS TO INTERPOLATE </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">NO</td><td>- INTEGER NUMBER OF OUTPUT POINTS (ONLY IF KGDSO(1)&lt;0) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">RLAT</td><td>- REAL (NO) OUTPUT LATITUDES IN DEGREES (IF KGDSO(1)&lt;0) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">RLON</td><td>- REAL (NO) OUTPUT LONGITUDES IN DEGREES (IF KGDSO(1)&lt;0) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">IBO</td><td>- INTEGER (KM) OUTPUT BITMAP FLAGS </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">LO</td><td>- LOGICAL*1 (MO,KM) OUTPUT BITMAPS (ALWAYS OUTPUT) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">GO</td><td>- REAL (MO,KM) OUTPUT FIELDS INTERPOLATED </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">IRET</td><td>- INTEGER RETURN CODE 0 SUCCESSFUL INTERPOLATION 1 UNRECOGNIZED INTERPOLATION METHOD 2 UNRECOGNIZED INPUT GRID OR NO GRID OVERLAP 3 UNRECOGNIZED OUTPUT GRID 1X INVALID BICUBIC METHOD PARAMETERS 3X INVALID BUDGET METHOD PARAMETERS 4X INVALID SPECTRAL METHOD PARAMETERS</td></tr>
  </table>
  </dd>
</dl>
<p>SUBPROGRAMS CALLED: POLATES0 INTERPOLATE SCALAR FIELDS (BILINEAR) POLATES1 INTERPOLATE SCALAR FIELDS (BICUBIC) POLATES2 INTERPOLATE SCALAR FIELDS (NEIGHBOR) POLATES3 INTERPOLATE SCALAR FIELDS (BUDGET) POLATES4 INTERPOLATE SCALAR FIELDS (SPECTRAL)</p>
<p>REMARKS: EXAMPLES DEMONSTRATING RELATIVE CPU COSTS. THIS EXAMPLE IS INTERPOLATING 12 LEVELS OF TEMPERATURES FROM THE 360 X 181 GLOBAL GRID (NCEP GRID 3) TO THE 93 X 68 HAWAIIAN MERCATOR GRID (NCEP GRID 204). THE EXAMPLE TIMES ARE FOR THE C90. AS A REFERENCE, THE CP TIME FOR UNPACKING THE GLOBAL 12 TEMPERATURE FIELDS IS 0.04 SECONDS.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">METHOD </th><th class="markdownTableHeadNone">IP </th><th class="markdownTableHeadNone">IPOPT </th><th class="markdownTableHeadNone">CP SECONDS  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">BILINEAR </td><td class="markdownTableBodyNone">0 </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">0.03  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">BICUBIC </td><td class="markdownTableBodyNone">1 </td><td class="markdownTableBodyNone">0 </td><td class="markdownTableBodyNone">0.07  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">BICUBIC </td><td class="markdownTableBodyNone">1 </td><td class="markdownTableBodyNone">1 </td><td class="markdownTableBodyNone">0.07  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NEIGHBOR </td><td class="markdownTableBodyNone">2 </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">0.01  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">BUDGET </td><td class="markdownTableBodyNone">3 </td><td class="markdownTableBodyNone">-1,-1 </td><td class="markdownTableBodyNone">0.48  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SPECTRAL </td><td class="markdownTableBodyNone">4 </td><td class="markdownTableBodyNone">0,40 </td><td class="markdownTableBodyNone">0.22  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SPECTRAL </td><td class="markdownTableBodyNone">4 </td><td class="markdownTableBodyNone">1,40 </td><td class="markdownTableBodyNone">0.24  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SPECTRAL </td><td class="markdownTableBodyNone">4 </td><td class="markdownTableBodyNone">0,-1 </td><td class="markdownTableBodyNone">0.42  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">N-BUDGET </td><td class="markdownTableBodyNone">6 </td><td class="markdownTableBodyNone">-1,-1 </td><td class="markdownTableBodyNone">0.15  </td></tr>
</table>
<p>THE SPECTRAL INTERPOLATION IS FAST FOR THE MERCATOR GRID. HOWEVER, FOR SOME GRIDS THE SPECTRAL INTERPOLATION IS SLOW. THE FOLLOWING EXAMPLE IS INTERPOLATING 12 LEVELS OF TEMPERATURES FROM THE 360 X 181 GLOBAL GRID (NCEP GRID 3) TO THE 93 X 65 CONUS LAMBERT CONFORMAL GRID (NCEP GRID 211).</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">METHOD </th><th class="markdownTableHeadNone">IP </th><th class="markdownTableHeadNone">IPOPT </th><th class="markdownTableHeadNone">CP SECONDS  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">BILINEAR </td><td class="markdownTableBodyNone">0 </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">0.03  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">BICUBIC </td><td class="markdownTableBodyNone">1 </td><td class="markdownTableBodyNone">0 </td><td class="markdownTableBodyNone">0.07  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">BICUBIC </td><td class="markdownTableBodyNone">1 </td><td class="markdownTableBodyNone">1 </td><td class="markdownTableBodyNone">0.07  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NEIGHBOR </td><td class="markdownTableBodyNone">2 </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">0.01  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">BUDGET </td><td class="markdownTableBodyNone">3 </td><td class="markdownTableBodyNone">-1,-1 </td><td class="markdownTableBodyNone">0.51  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SPECTRAL </td><td class="markdownTableBodyNone">4 </td><td class="markdownTableBodyNone">0,40 </td><td class="markdownTableBodyNone">3.94  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SPECTRAL </td><td class="markdownTableBodyNone">4 </td><td class="markdownTableBodyNone">1,40 </td><td class="markdownTableBodyNone">5.02  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SPECTRAL </td><td class="markdownTableBodyNone">4 </td><td class="markdownTableBodyNone">0,-1 </td><td class="markdownTableBodyNone">11.36  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">N-BUDGET </td><td class="markdownTableBodyNone">6 </td><td class="markdownTableBodyNone">-1,-1 </td><td class="markdownTableBodyNone">0.18  </td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="ipolates_8f90_source.html#l00128">128</a> of file <a class="el" href="ipolates_8f90_source.html">ipolates.f90</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="ipolates_8f90.html">ipolates.f90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
